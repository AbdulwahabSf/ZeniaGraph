<!-- sldsValidatorIgnore -->
<template>
	<lightning-quick-action-panel >
	<template if:true={isLoading}>
		<lightning-spinner variant="brand" alternative-text="Loading" size="large"></lightning-spinner>
	</template>
   
     <template if:true={showEmptyErr}>
		 	<div class=" slds-text-color_error slds-page-header__title slds-align_absolute-center">
			No Records Found</div>
			<br>
		<lightning-button class="slds-align_absolute-center" variant="brand" label="Go Back" onclick={handleGoBack}></lightning-button>
     </template>
	<template if:true={showError}>
		<div class=" slds-text-color_error slds-page-header__title slds-align_absolute-center">
			Please select a Record</div>
		<br>
		<div if:false={recordId} class="slds-align_absolute-center">
			<lightning-button variant="brand" label="Go Back" onclick={handleGoBack}></lightning-button>
		</div>
	</template>

	<template if:true={showResponseTable}>
		<div id="containerDiv" onmousemove={handlemousemove} onmouseup={handlemouseup}
         ondblclick={handledblclickresizable}
         class="slds-table_header-fixed_container slds-border_right slds-border_left tableScroll"
         onscroll={tableOuterDivScrolled}>
		<div id="tableViewInnerDiv" onscroll={tableScrolled} class="slds-scrollable_y tableViewInnerDiv">
 
		<table class="slds-table slds-table_bordered slds-table_header-fixed slds-table_resizable-cols slds-table_fixed-layout" >
			<thead>
				<tr>
					<th class="slds-is-resizable dv-dynamic-width" style="width:6rem;" >
						<div class="slds-cell-fixed" >
							<a class="slds-th__action slds-text-link--reset ">
						<div class="slds-truncate" title="Source">Action</div>
							</a>
							<!-- <div class="slds-resizable">
                                    <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                        <span class="slds-resizable__divider"></span>
                                    </span>
                                </div> -->
                            </div> 
					</th>
					<th class="slds-is-resizable dv-dynamic-width" scope="col" style={fixedWidth}>
						<div class="slds-cell-fixed" style={fixedWidth}>
						  <a class="slds-th__action slds-text-link--reset ">
						<div class="slds-truncate" style={fixedWidth} title="Company">Company</div>
						  </a>
						   <div class="slds-resizable">
                                    <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                        <span class="slds-resizable__divider"></span>
                                    </span>
                                </div>
                            </div>
					</th>
					<th class="slds-is-resizable dv-dynamic-width" scope="col" style={fixedWidth}>
						 <div class="slds-cell-fixed" style={fixedWidth}>
							  <a class="slds-th__action slds-text-link--reset ">
						<div class="slds-truncate" title="Industry">Industry</div>
							  </a>
							  <div class="slds-resizable">
                                    <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                        <span class="slds-resizable__divider"></span>
                                    </span>
                                </div>
                            </div>
							  
					</th>
					<th class="slds-is-resizable dv-dynamic-width" scope="col" style={fixedWidth}>
						<div class="slds-cell-fixed" style={fixedWidth}>
							  <a class="slds-th__action slds-text-link--reset ">
						<div class="slds-truncate" title="SIC">SIC Code</div>
							  </a>
							  <div class="slds-resizable">
                                    <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                        <span class="slds-resizable__divider"></span>
                                    </span>
                                </div>
                            </div>
					</th>
					<th class="slds-is-resizable dv-dynamic-width" scope="col" style={fixedWidth}>
						<div class="slds-cell-fixed" style={fixedWidth}>
							 <a class="slds-th__action slds-text-link--reset ">
						<div class="slds-truncate" title="NAICS">NAICS Code</div>
							 </a>
							  <div class="slds-resizable">
                                    <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                        <span class="slds-resizable__divider"></span>
                                    </span>
                                </div>
                            </div>
					</th>
						<!-- <template if:true={displaySource}>
					 <th class="slds-is-resizable dv-dynamic-width" scope="col" style={fixedWidth}>
						 <div class="slds-cell-fixed" style={fixedWidth}>
							 	 <a class="slds-th__action slds-text-link--reset ">
						<div class="slds-truncate" title="Source">Source</div>
							 	   </a>
								   <div class="slds-resizable">
                                    <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                        <span class="slds-resizable__divider"></span>
                                    </span>
                                    </div>
                            </div>
					</th> 
						</template> -->
					<th class="slds-is-resizable dv-dynamic-width" scope="col" style={fixedWidth}>
						 <div class="slds-cell-fixed" style={fixedWidth}>
							 	 <a class="slds-th__action slds-text-link--reset ">
						<div class="slds-truncate" title="Source">Vector Score</div>
							 	 </a>
								  <div class="slds-resizable">
                                    <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                        <span class="slds-resizable__divider"></span>
                                    </span>
                                </div>
                            </div>
					</th>
					
				</tr>
			</thead>
			<tbody>
				<template for:each={data} for:item="ld" for:index="index">

					<!-- <template if:true={ld.showRecord}> -->
						<tr key={ld.id} class={ld.selectedRowClass}>
							<td >
								<template if:true={ld.showAdd}>
									<div class="slds-truncate dv-dynamic-width" style={fixedWidth}>
									<lightning-button name="Action" label="Add" data-id={index}
										onclick={addCompanyRecord}>
									</lightning-button>
									</div>
								</template>
								<template if:true={ld.showUpdate}>
									<div class="slds-truncate dv-dynamic-width" style={fixedWidth}>
									<lightning-button name="Action" label="Update" data-id={index}
										onclick={addCompanyRecord}>
									</lightning-button>
									</div>
								</template>
							</td>
							<td scope="col">
								<div class="slds-truncate dv-dynamic-width" style={fixedWidth}>
									<template if:true={ld.hasContacts}>
										<lightning-icon data-id={index} icon-name='utility:info_alt' size='x-small'
										title='Contact Details' onclick={displayContactDetails}>
									</lightning-icon></template> {ld.name}
								</div>
							</td>
							<td  >
								<div class="slds-truncate dv-dynamic-width" style={fixedWidth}>{ld.industry}</div>
							</td>
							<td >
								<div class="slds-truncate dv-dynamic-width" style={fixedWidth}>{ld.SIC}</div>
							</td>
							<td >
								<div class="slds-truncate dv-dynamic-width" style={fixedWidth}>{ld.NAICS}</div>
							</td>
							<!-- <template if:true={displaySource}>
						    <td >
								<div class="slds-truncate dv-dynamic-width" style={fixedWidth}>{ld.source}</div>
							</td> 
							</template> -->
							<td >
								<div class="slds-truncate dv-dynamic-width" style={fixedWidth}>{ld.vector_score}</div>
							</td>
							
						</tr>
					<!-- </template> -->
				</template>
			</tbody>
		</table>
		</div>
		</div>

		<footer class="slds-modal__footer">
			<div class="slds-grid slds-gutters slds-align_absolute-center">
				<lightning-layout>
					<lightning-layout-item class="slds-m-top_small slds-m-left_x-small">
						<lightning-button label="Go Back" variant="brand-outline" onclick={handleGoBack}>
						</lightning-button>
					</lightning-layout-item>
					<template if:true={showSimilarCompany}>
						<lightning-layout-item class="slds-m-top_small slds-m-left_x-small">
							<lightning-button label="Show KG" variant="brand"
								onclick={handleShowSimilarCompany} disabled={showButton}></lightning-button>
						</lightning-layout-item>
					</template>
				</lightning-layout>
			</div>
		</footer>
	</template>

	<template if:true={showTable}>

		<div class=" slds-text-color_error slds-page-header__title slds-align_absolute-center">Please Select Only One Record</div>
		<br>
		<h1>
			<span class="slds-page-header__title slds-truncate" title="Currently Selected Companies">Currently Selected Companies</span>
		</h1>
		<br>

		<lightning-datatable key-field="Id" data={leadsData} columns={columns} onrowselection={handleRowSelection}>
		</lightning-datatable>

		<footer class="slds-modal__footer">
			<div class="slds-grid slds-gutters slds-align_absolute-center">
				<lightning-layout>
					<lightning-layout-item class="slds-m-top_small slds-m-left_x-small">
						<lightning-button label="Go Back" variant="brand-outline" onclick={handleGoBack}>
						</lightning-button>
					</lightning-layout-item>
					<!--<lightning-layout-item class="slds-m-top_small slds-m-left_x-small">
						<lightning-button label="Show Similar Company" variant="brand" onclick={handleShowSimilarCompany}
							disabled={showButton}></lightning-button>
					</lightning-layout-item>-->
				</lightning-layout>
			</div>
		</footer>
	</template>
	</lightning-quick-action-panel>
</template>